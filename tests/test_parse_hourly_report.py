import pprint
from unittest import TestCase

from doe2_sim_parser import split_sim
from doe2_sim_parser.parse_hourly_report import parse_single_page_hourly_report, \
    parse_hourly_report
from doe2_sim_parser.utils.data_types import Report
from tests import SAMPLE_SIM_HOURLY_REPORT

pp = pprint.PrettyPrinter(indent=4, width=180)


class ParseHourlyReportTest(TestCase):
    maxDiff = None

    def setUp(self):
        self.hourly_report_day = Report(
            type_="hourly_report",
            code=None,
            name=None,
            report=[
                "\x0c01-baseline-000                                                                  DOE-2.2-48z    3/06/2019     5:22:56  BDL RUN  1",
                "                                                                                                                        ",
                "HOURLY REPORT- Hourly Report                     HVAC                            WEATHER FILE- EPW Kunming,Yunnan,C Pg:    1 -  1",
                "---------------------------------------------------------------------------------------------------------------------------------",
                "MMDDHH   EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1     ",
                "                                                                                                                             ",
                "            LIGHT        TASK       EQUIP        HEAT        COOL       HTREJ         AUX        VENT        REFG        SUPP",
                "          END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE",
                "         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH     ",
                "                                                                                                                             ",
                "         ----( 1)    ----( 2)    ----( 3)    ----( 4)    ----( 5)    ----( 6)    ----( 7)    ----( 8)    ----( 9)    ----(10)",
                " 1 1 1     165.228       0.000      24.811     348.534       0.000       0.000      91.974     201.088       0.000       0.000",
                " 1 1 2     165.228       0.000      24.811     341.445       0.000       0.000      91.974     201.088       0.000       0.000",
                " 1 1 3     165.228       0.000      24.811     378.910       0.000       0.000      91.974     223.678       0.000       0.000",
                " 1 1 4     165.228       0.000      24.811     426.376       0.000       0.000      91.974     223.678       0.000       0.000",
                " 1 1 5     165.228       0.000      24.811     465.691       0.000       0.000      91.974     223.678       0.000       0.000",
                " 1 1 6     165.228       0.000      24.811     510.834       0.000       0.000      91.974     248.949       0.000       0.000",
                " 1 1 7     165.228       0.000     462.824     541.686       0.000       0.000      91.974     248.949       0.000       0.000",
                " 1 1 8     165.228       0.000     462.824     578.547       0.000       0.000      91.974     248.949       0.000       0.000",
                " 1 1 9     165.228       0.000     462.824     607.171       0.000       0.000      91.974     248.949       0.000       0.000",
                " 1 110     444.957       0.000     726.284     456.398       0.000       0.000      91.974     248.949       0.000       0.000",
                " 1 111     693.213       0.000     964.603     240.341       0.000       0.000      91.974     201.088       0.000       0.000",
                " 1 112     693.213       0.000    1124.603     196.393      62.891       0.000      91.974     201.088       0.000       0.000",
                " 1 113     693.213       0.000    1164.603      38.628      80.591       0.088      91.974     155.032       0.000       0.000",
                " 1 114     693.213       0.000    1164.603       0.000     100.471       0.311      91.974     113.408       0.000       0.000",
                " 1 115     693.213       0.000    1164.603       0.000      53.528       0.000      91.974      21.800       0.000       0.000",
                " 1 116     693.213       0.000    1164.603       0.000     147.204       0.990      91.974     130.857       0.000       0.000",
                " 1 117     693.213       0.000    1164.603       1.463     157.195       1.146      91.974     193.316       0.000       0.000",
                " 1 118     508.315       0.000     976.897       0.000      72.550       0.028      91.974      22.408       0.000       0.000",
                " 1 119     165.228       0.000     438.824       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                " 1 120     165.228       0.000     438.824      11.395      61.188       0.000      91.974      46.475       0.000       0.000",
                " 1 121     165.228       0.000     438.824      85.716      63.460       0.000      91.974     167.961       0.000       0.000",
                " 1 122     165.228       0.000     438.824     152.919      64.019       0.000      91.974     201.088       0.000       0.000",
                " 1 123     165.228       0.000     438.824     215.977      39.791       0.000      91.974     201.088       0.000       0.000",
                " 1 124     165.228       0.000      40.811     251.831      51.864       0.000      91.974     201.088       0.000       0.000",
                "",
                " DAILY SUMMARY (JAN  1)",
                "    MN     165.228       0.000      24.811       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "    MX     693.213       0.000    1164.603     607.171     157.195       1.146      91.974     248.949       0.000       0.000",
                "    SM    8284.186       0.000   13387.662    5850.256     954.754       2.564    2115.396    4174.648       0.000       0.000",
                "    AV     345.174       0.000     557.819     243.761      39.781       0.107      88.141     173.944       0.000       0.000",
            ],
            report_no=1,
            page_no=1
        )
        self.hourly_report_month = Report(
            type_="hourly_report",
            code=None,
            name=None,
            report=[
                "01-baseline-000                                                                  DOE-2.2-48z    3/06/2019     5:22:56  BDL RUN  1",
                "                                                                                                                        ",
                "HOURLY REPORT- Hourly Report                     HVAC                            WEATHER FILE- EPW Kunming,Yunnan,C Pg:   31 -  1",
                "---------------------------------------------------------------------------------------------------------------------------------",
                "         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1     ",
                "                                                                                                                             ",
                "            LIGHT        TASK       EQUIP        HEAT        COOL       HTREJ         AUX        VENT        REFG        SUPP",
                "          END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE",
                "         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH     ",
                "                                                                                                                             ",
                "         ----( 1)    ----( 2)    ----( 3)    ----( 4)    ----( 5)    ----( 6)    ----( 7)    ----( 8)    ----( 9)    ----(10)",
                " 131 1     237.697       0.000      82.702       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                " 131 2     237.697       0.000      82.702       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                " 131 3     237.697       0.000      82.702      15.480      77.902       0.000      91.974      45.902       0.000       0.000",
                " 131 4     237.697       0.000      82.702      41.926       0.000       0.000      91.974      93.718       0.000       0.000",
                " 131 5     237.697       0.000      82.702      77.395       0.000       0.000      91.974     126.221       0.000       0.000",
                " 131 6     237.697       0.000      82.702      88.597       0.000       0.000      91.974     130.100       0.000       0.000",
                " 131 7     255.503       0.000     534.940     108.243       0.000       0.000      91.974     165.180       0.000       0.000",
                " 131 8     467.733       0.000     744.478     121.097       0.000       0.000      91.974     167.390       0.000       0.000",
                " 131 9    1212.503       0.000    1419.435     104.491       0.000       0.000      91.974     166.289       0.000       0.000",
                " 13110    1887.289       0.000    2238.485     551.689       0.000       0.000      91.974     593.453       0.000       0.000",
                " 13111    1997.648       0.000    2406.646     212.506      45.489       0.000      91.974     688.607       0.000       0.000",
                " 13112    1997.648       0.000    2446.646     129.372     146.933       0.904      91.974     719.271       0.000       0.000",
                " 13113    1997.648       0.000    2446.646      88.369     224.410       2.357      91.974     797.667       0.000       0.000",
                " 13114    1997.648       0.000    2446.646      55.029     286.567       3.188      91.974     852.891       0.000       0.000",
                " 13115    1997.648       0.000    2446.646      48.733     260.383       2.825      91.974     895.563       0.000       0.000",
                " 13116    1997.648       0.000    2446.646      24.008     319.077       3.560      91.974     894.532       0.000       0.000",
                " 13117    1997.648       0.000    2406.646      16.744     341.151       3.768      91.974     882.212       0.000       0.000",
                " 13118    1909.651       0.000    2296.350      19.638     321.446       3.547      91.974     794.557       0.000       0.000",
                " 13119    1441.504       0.000    1842.371      34.761     265.632       2.901      91.974     605.060       0.000       0.000",
                " 13120    1095.310       0.000    1525.817      58.207     199.287       1.862      91.974     538.738       0.000       0.000",
                " 13121     461.728       0.000    1019.682     111.200     162.399       1.158      91.974     532.278       0.000       0.000",
                " 13122     255.503       0.000     574.940       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                " 13123     237.697       0.000     496.715       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                " 13124     237.697       0.000      98.702       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "",
                " DAILY SUMMARY (JAN 31)",
                "    MN     237.697       0.000      82.702       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "    MX    1997.648       0.000    2446.646     551.689     341.151       3.768      91.974     895.563       0.000       0.000",
                "    SM   24871.832       0.000   30334.646    1907.487    2650.676      26.070    1747.501    9689.628       0.000       0.000",
                "    AV    1036.326       0.000    1263.944      79.479     110.445       1.086      72.813     403.734       0.000       0.000",
                "",
                " MONTHLY SUMMARY (JAN)",
                "    MN     165.228       0.000      24.811       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "    MX    1997.648       0.000    2486.646    2078.694     362.315       4.102      91.974     908.421       0.000       0.000",
                "    SM  700339.250       0.000  874529.438  121869.039   53434.859     454.476   57759.496  279788.156       0.000       0.000",
                "    AV     941.316       0.000    1175.443     163.802      71.821       0.611      77.634     376.059       0.000       0.000",
            ],
            report_no=1,
            page_no=31,
        )
        self.hourly_report_year = Report(
            type_="hourly_report",
            code=None,
            name=None,
            report=[
                "01-baseline-000                                                                  DOE-2.2-48z    3/06/2019     5:22:56  BDL RUN  1",
                "                                                                                                                        ",
                "HOURLY REPORT- Hourly Report                     HVAC                            WEATHER FILE- EPW Kunming,Yunnan,C Pg:  365 -  1",
                "---------------------------------------------------------------------------------------------------------------------------------",
                "         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1         EM1     ",
                "                                                                                                                             ",
                "            LIGHT        TASK       EQUIP        HEAT        COOL       HTREJ         AUX        VENT        REFG        SUPP",
                "          END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE     END USE",
                "         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH         KWH     ",
                "                                                                                                                             ",
                "         ----( 1)    ----( 2)    ----( 3)    ----( 4)    ----( 5)    ----( 6)    ----( 7)    ----( 8)    ----( 9)    ----(10)",
                "1231 1     237.697       0.000      82.702      35.170      74.594       0.000      91.974      97.961       0.000       0.000",
                "1231 2     237.697       0.000      82.702      73.094       0.000       0.000      91.974     131.040       0.000       0.000",
                "1231 3     237.697       0.000      82.702      95.302       0.000       0.000      91.974     168.312       0.000       0.000",
                "1231 4     237.697       0.000      82.702     114.104       0.000       0.000      91.974     168.312       0.000       0.000",
                "1231 5     237.697       0.000      82.702     135.013       0.000       0.000      91.974     201.088       0.000       0.000",
                "1231 6     237.697       0.000      82.702     155.242       0.000       0.000      91.974     201.088       0.000       0.000",
                "1231 7     237.697       0.000     520.715     172.731       0.000       0.000      91.974     226.359       0.000       0.000",
                "1231 8    1170.471       0.000    1305.858     150.517       0.000       0.000      91.974     201.088       0.000       0.000",
                "1231 9    1997.648       0.000    2046.646    1132.473       0.000       0.000      91.974     608.538       0.000       0.000",
                "123110    1997.648       0.000    2406.646     557.373      39.742       0.000      91.974     651.240       0.000       0.000",
                "123111    1997.648       0.000    2486.646     319.368      39.153       0.000      91.974     678.014       0.000       0.000",
                "123112    1997.648       0.000    2446.646     160.491     101.398       0.238      91.974     733.516       0.000       0.000",
                "123113    1997.648       0.000    2446.646     118.166     171.684       1.434      91.974     748.310       0.000       0.000",
                "123114    1997.648       0.000    2446.646      86.605     216.385       2.190      91.974     752.860       0.000       0.000",
                "123115    1997.648       0.000    2446.646      51.864     286.908       3.186      91.974     759.569       0.000       0.000",
                "123116    1997.648       0.000    2446.646      27.286     340.336       3.724      91.974     805.806       0.000       0.000",
                "123117    1997.648       0.000    2446.646      20.336     359.037       3.857      91.974     794.569       0.000       0.000",
                "123118    1997.648       0.000    2446.646      25.427     322.678       3.542      91.974     742.579       0.000       0.000",
                "123119    1381.665       0.000    1954.570      43.839     257.097       2.794      91.974     599.730       0.000       0.000",
                "123120    1170.471       0.000    1705.858      82.482     177.664       1.463      91.974     602.991       0.000       0.000",
                "123121     237.697       0.000     920.715     157.983     151.511       0.928      91.974     589.678       0.000       0.000",
                "123122     237.697       0.000     560.715       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "123123     237.697       0.000     496.715       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "123124     237.697       0.000      98.702       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "",
                " DAILY SUMMARY (DEC 31)",
                "    MN     237.697       0.000      82.702       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "    MX    1997.648       0.000    2486.646    1132.473     359.037       3.857      91.974     805.806       0.000       0.000",
                "    SM   26313.750       0.000   32126.520    3714.868    2538.186      23.357    1931.448   10462.647       0.000       0.000",
                "    AV    1096.406       0.000    1338.605     154.786     105.758       0.973      80.477     435.944       0.000       0.000",
                "",
                " MONTHLY SUMMARY (DEC)",
                "    MN     165.228       0.000      24.811       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "    MX    1997.648       0.000    2486.646    2616.598     592.047      18.472     183.947    1039.077       0.000       0.000",
                "    SM  719810.750       0.000  895060.250  158323.781   46437.148     464.266   42767.777  291640.656       0.000       0.000",
                "    AV     967.488       0.000    1203.038     212.801      62.416       0.624      57.484     391.990       0.000       0.000",
                "",
                " YEARLY SUMMARY",
                "    MN     165.228       0.000      24.811       0.000       0.000       0.000       0.000       0.000       0.000       0.000",
                "    MX    1997.648       0.000    2486.646    2616.598    2098.067     106.984     430.664    1557.728       0.000       0.000",
                "    SM 8411706.000       0.000 ***********  491055.781 2896690.000   92511.266  807383.000 3860096.000       0.000       0.000",
                "    AV     960.240       0.000    1195.341      56.057     330.672      10.561      92.167     440.650       0.000       0.000",
            ],
            report_no=1,
            page_no=365,
        )

        sim = split_sim(SAMPLE_SIM_HOURLY_REPORT)
        self.hourly_report = sim.hourly_reports

    def tearDown(self):
        pass

    # def test__parse_hourly_report(self):
    #     hourly_report_day = _parse_hourly_report(self.hourly_report_day)
    #
    #     pp.pprint(hourly_report_day)

    # def test_parse_single_hourly_report(self):
    #     hourly_report = parse_single_page_hourly_report(self.hourly_report_day)
    #     pp.pprint(hourly_report)

    def test_parse_hourly_report(self):
        hourly_report = parse_hourly_report(self.hourly_report)

        pp.pprint(hourly_report)
